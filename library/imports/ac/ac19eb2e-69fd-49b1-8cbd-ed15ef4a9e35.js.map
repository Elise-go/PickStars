{"version":3,"sources":["assets\\scripts\\Player.js"],"names":["cc","Class","Component","properties","jumpHeight","jumpDuration","squashDuration","maxMoveSpeed","accel","jumpAudio","type","AudioClip","onLoad","enabled","accLeft","accRight","xSpeed","minPosX","node","parent","width","maxPosX","setInputControl","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","Node","TOUCH_START","onTouchBegan","TOUCH_END","onTouchEnded","event","keyCode","macro","KEY","a","left","d","right","touchLoc","getLocation","x","winSize","startMoveAt","pos","setPosition","jumpAction","runJumpAciton","tween","then","start","jumpUp","by","y","easing","jumpDown","squash","to","scaleX","scaleY","stretch","scaleBack","sequence","call","playJumpSound","repeatForever","audioEngine","playEffect","getCenterPos","centerPos","v2","height","update","dt","Math","abs","onDestroy","off"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n      //主角跳跃高度\n      jumpHeight:0,\n      //主角跳跃持续时间\n      jumpDuration:0,\n      //辅助形变动作时间\n      squashDuration:0,\n      //最大移动速度\n      maxMoveSpeed:0,\n      //加速度\n      accel:0,\n      //跳跃音效资源\n      jumpAudio:{\n        default:null,\n        type:cc.AudioClip\n      }\n    },\n\n    onLoad:function(){\n      this.enabled = false;\n\n      //加速度方向开关\n      this.accLeft = false;\n      this.accRight = false;\n      //主角当前水平方向速度\n      this.xSpeed = 0;\n      //页面边界\n      this.minPosX = - this.node.parent.width/2 + this.node.width/2;\n      this.maxPosX = this.node.parent.width/2 - this.node.width/2;\n      //初始化键盘输入监听\n      this.setInputControl();\n    },\n\n    /************setInputControl()开始***************/\n    setInputControl(){\n      cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\n      cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\n\n      this.node.parent.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this);\n      this.node.parent.on(cc.Node.EventType.TOUCH_END,this.onTouchEnded,this)\n    },\n\n    onKeyDown(event){\n      switch(event.keyCode){\n        case cc.macro.KEY.a:\n        case cc.macro.KEY.left:\n          this.accLeft = true;\n          break;\n        case cc.macro.KEY.d:\n        case cc.macro.KEY.right:\n          this.accRight = true;\n          break;\n      }\n    },\n    onKeyUp(event){\n      switch(event.keyCode){\n        case cc.macro.KEY.a:\n        case cc.macro.KEY.left:\n          this.accLeft = false;\n          break;\n        case cc.macro.KEY.d:\n        case cc.macro.KEY.right:\n          this.accRight= false;\n          break;\n      }\n    },\n\n    onTouchBegan(event){\n      var touchLoc = event.getLocation();\n      if(touchLoc.x >= cc.winSize.width/2){\n        this.accRight = true;\n      }else{\n        this.accLeft = true;\n      }\n      //don't capture the event\n      return true;\n    },\n\n    onTouchEnded(event){\n      this.accLeft = false;\n      this.accRight = false;\n    },\n\n    /************setInputControl()结束***************/\n\n\n    /************ startMoveAt()开始***************/\n    startMoveAt(pos){  //Game.js--onStartGame()调用\n      //启用该脚本组件\n      this.enabled = true;\n      this.node.setPosition(pos);\n      this.xSpeed = 0;\n\n      var jumpAction = this.runJumpAciton();\n      cc.tween(this.node).then(jumpAction).start();\n    },\n\n    runJumpAciton(){\n      //跳跃上升\n      var jumpUp = cc.tween().by(this.jumpDuration,{y:this.jumpHeight},{easing:'sineOut'});\n      //下落\n      var jumpDown = cc.tween().by(this.jumpDuration,{y:-this.jumpHeight},{easing:'sineIn'});\n      //形变\n      var squash = cc.tween().to(this.squashDuration,{scaleX: 1, scaleY: 0.6}); //挤压\n      var stretch = cc.tween().to(this.squashDuration,{scaleX: 1, scaleY: 1.2}); //伸展\n      var scaleBack =cc.tween().to(this.squashDuration,{scaleX: 1, scaleY: 1}); //复原\n      //创建一个缓动\n      var tween = cc.tween()\n                    .sequence(squash,stretch,jumpUp,scaleBack,jumpDown)\n                    //添加一个回调函数，在前面的动作都结束时调用playJumpSound()方法\n                    .call(this.playJumpSound,this);\n      return cc.tween().repeatForever(tween);\n    },\n\n    playJumpSound(){\n      cc.audioEngine.playEffect(this.jumpAudio,false);\n    },\n    /************ startMoveAt()结束***************/\n\n    getCenterPos(){ //Star.js--getPlayerDistance()调用\n      var centerPos = cc.v2(this.node.x, this.node.y + this.node.height/2);\n      return centerPos;\n    },\n\n\n    update:function(dt){\n    \n      //根据当前加速度方向每帧更新速度\n      if(this.accLeft){\n        this.xSpeed -= this.accel*dt;\n      }else if(this.accRight){\n        this.xSpeed += this.accel*dt;\n      }\n\n      //限定主角的速度不能超过最大值\n      if(Math.abs(this.xSpeed) > this.maxMoveSpeed){\n        this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\n      }\n\n      //根据当前速度更新主角的位置\n      this.node.x += this.xSpeed*dt;\n\n      //限制主角的移动不能超过视窗边界\n      if(this.node.x > this.maxPosX){\n        this.node.x = this.maxPosX;\n        this.xSpeed = 0;\n      }else if(this.node.x < this.minPosX){\n        this.node.x = this.minPosX;\n        this.xSpeed = 0;\n      }\n    },\n\n    //取消键盘输入监听\n    onDestroy(){\n      cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\n      cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\n\n    }\n   \n});\n"]}